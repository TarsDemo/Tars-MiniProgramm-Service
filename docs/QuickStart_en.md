# <a id="create-first-app"></a>Create Your First TARS Application

Once we install TARS environment, we can deploy services on TARS. If you have not installed yet, refer to [TARS Installation](https://tarscloud.github.io/TarsDocs_en/installation/source.html)。

Now, let's create our first TARS application Hello World. TARS supports multiple languages, and we use C++ as example here to use TarsCpp. The development progress is similar for other languages.

## Content

> * [Install TarsCpp Development Framework](#install-tarscpp)
> * [Create A Service](#create-project)
> * [Add Interface](#add-interface)
> * [Package Service](#server-packing)
> * [Deploy Service](#server-deploy)
> * [Test Interface](#interface-debug)

## <a id="install-tarscpp"></a>Install TarsCpp Development Framework

Before creating an project, we need to install the development framework for the language you use first. We can download, compile and install TarsCpp through the following command

```sh
git clone https://github.com/TarsCloud/TarsCpp.git --recursive
cd TarsCpp
cmake .
make
make install
```

The installation path is `/usr/local/tars/cpp/`
* In path `/usr/local/tars/cpp/script/`, there are two script for creating an TarsCpp service, `cmake_tars_server.sh` and `cmake_http_server.sh`, which are use to create service using tars protocol and HTTP protocol respectively.
* In path `/usr/local/tars/cpp/tools/`, there are several scripts for transferring tars protocol file to code. For example, script `tars2cpp` can transfer tars protocol file to C++ code and `tars2go` to Golang code.

## <a id="create-project"></a>Create A Service

We can use the script `cmake_tars_server.sh` to create a TARS server like the following

```sh
sh /usr/local/tars/cpp/script/cmake_tars_server.sh FirstApp HelloServer Hello
```

> The three params `FirstApp`, `HelloServer`, `Hello` are the name of `App`, `Server`, `Servant` respectively.
> * App: The application name, which identifies a small set of services.
> * Server: Server is the service name, the name of the program providing business services.
> * Servant: Servant is a service provider, which provides a number of specific interfaces for clients to call.
>
> The relationship is that, an App can have several servers, and a server can have several servants. By using `App+Server+Servant`, we can uniquely identify a servant.

After executing the script, the following directories and files will be generated in the current directory

```sh
.
└── HelloServer
    ├── build
    ├── CMakeLists.txt          # cmake file
    └── src
        ├── HelloServer.h       # service implement
        ├── HelloServer.cpp
        ├── Hello.tars          # tars protocol file
        ├── HelloImp.h          # hello interface implement class
        ├── HelloImp.cpp
        └── CMakeLists.txt
```

## <a id="add-interface"></a>Add Interface

### tars protocol file

`Hello.tars` is the file for defining interface of service using tars protocol, which will auto-gen a interface `test` as default, as following

```cpp
module FirstApp
{
interface Hello
{
    int test();
}
}
```

We define an interface `hello`, which response an parameter of type `string`. The content of `Hello.tars` is as the following

```cpp
module FirstApp
{
interface Hello
{
    int test();
    int hello(out string res);
}
}
```

Then, use script `tars2cpp` to generate C++ header file `hello.h` as the following

```sh
/usr/local/tars/cpp/tools/tars2cpp hello.tars
```

The structure is as below.

```sh
.
└── HelloServer
    ├── build
    ├── CMakeLists.txt          # cmake file
    └── src
        ├── HelloServer.h       # service implement
        ├── HelloServer.cpp
        ├── Hello.tars          # tars protocol file
        ├── Hello.h             # c++ code generated by tars file
        ├── HelloImp.h          # hello interface implement class
        ├── HelloImp.cpp
        └── CMakeLists.txt
```

### Add the implement for interface `hello` in class `HelloImp`

`HelloImp` is the class for interface implementation. Let's add the implementation for interface `hello`.

First, add the declaration for interface in `HelloImp.h`

```cpp
#ifndef _HelloImp_H_
#define _HelloImp_H_

#include "servant/Application.h"
#include "Hello.h"
/**
 * HelloImp inherent from Hello defined in hello.h
 */
class HelloImp : public TestApp::Hello
{
public:
    virtual ~HelloImp() {}

    /**
     * initialize
     */
    virtual void initialize();

    /**
     * destroy, run when destruct
     */
    virtual void destroy();

    /**
     * implement for test
     */
    virtual int test(tars::TarsCurrentPtr current) { return 0;};
    // implement for hello
    virtual int hello(std::string &res, tars::TarsCurrentPtr current);
};
/////////////////////////////////////////////////////
#endif
```

然后在 `HelloImp.cpp` 中添加 `hello` 接口的定义

```cpp
#include "HelloImp.h"
#include "servant/Application.h"

#include <string>

using namespace std;

//////////////////////////////////////////////////////
void HelloImp::initialize()
{
    //initialize servant here:
}

//////////////////////////////////////////////////////
void HelloImp::destroy()
{
    //destroy servant here:
}
//////////////////////////////////////////////////////
// hello 
int HelloImp::hello(string &res, tars::TarsCurrentPtr current)
{
    res = "Hello World";  // Response Hello World
    return 0;
}
```

Now, we finish interface `hello`.

## <a id="server-packing"></a>Package Service
### Build and package

Enter path `build` and execute the following command to build and package

```sh
cd build
cmake ..
make
make tar
```

A publish package `HelloServer.tgz` will be generate in this path.

### Download package

If you use virtual machine with GUI and browser, you can skip this part by using the browser inside the VM.

* If you use Windows, and use PuTTY to connect to your server, you can use command `pscp` to download

```sh
pscp -scp root@1.2.3.4:${Projecy Dir}/FirstApp/HelloServer/HelloServer.tgz ./
```

* If you use Xshell, you can use command `sz`, which need to be installed by command `yum install -y lrzsz` in your server. Then download the package by the following command.

```sh
sz HelloServer.tgz
```

* If you use MacOS or Linux, you can directly use command `scp`

```sh
scp root@1.2.3.4:${Project Dir}/FirstApp/HelloServer/HelloServer.tgz ./
```

## <a id="server-deploy"></a>Deploy and Publish

### Service Deploy

Open the browser and enter the TarsWeb page. (By accessing the port `3000` of server of VM with url `${IP or hostname}:3000`, for example, `1.2.3.4:3000`)

![](/docs/images/QuickStartTarsWeb.png)

Go to `Operation->Deploy service`, and deploy the service according to the following configuration.

* Service info: 
    * APP: `FirstApp`
    * Service name: `HelloServer`
    * Service type: `tars_cpp`
    * Template: `tars.cpp.default`
* Obj info: 
    * OBJ: `HelloObj`
    * Protocol: TARS
    * Port: Auto Generate

`OBJ` is the `Servant` name + `Obj`, for exmaple, this project's `Servant` name is `Hello`, so the `OBJ` name is `HelloObj`.

Select a server node that you want to deploy your server on in `Node` field, and click `get port` to automatically generate a port that can be use.

![](/docs/images/QuickStartServerDeploy.png)

Click `ok` to confirm deploy supply and you can see the service in the `Services` page.

![](/docs/images/QuickStartServerManage.png)

### Publish Service

Deploy service is like to prepare a place for the service. To run the servcie, we need to upload our publish package.

Open the TarsWeb page, and in the left tab in `Services` page, click the service that we just deployed, which is `FirstApp > HelloServer`. Then the right tab will display the information of this service.

![](/docs/images/QuickStartHelloServer.png)

Click the `Publish` in the top tab. Select a node and click `publish node`
![](/docs/images/QuickStartDeployManage_0.png)

Then

1. Click `upload release package`, and upload the package we downloaded.
2. In `release version`, select the version we just uploaded.
3. Click `publish`, then the service is published.

![](/docs/images/QuickStartDeployManage.png)

Go back `Services`, we can see the service is published successfully with status `Active`. The published log is in `Real Time Service Status`.

![](/docs/images/QuickStartServerDeploySucc.png)

## <a id="interface-debug"></a> Interface Debuger

In this section, we will test if our interfece work.

Click `Interface Debuger`, then
1. click `add` to upload the tars file `Hello.tars`, then we will see a new record of tars file like the following.
2. Click `debug`, you will jump to the debug page.

![](/docs/images/QuickStartUploadTarsFile.png)

In the debug page,
1. Select the interface that you want to debug, `FirstApp/Hello/hello`
2. Click `debug`

Then you can see the data responsed in the right tab. `"res":"Hello World"` is the data responsed by interface `hello`. The left tab is use to enter input parameters for the interface.  With interface `hello` has no input parameter, there is no need to enter anything.

![](/docs/images/QuickStartDebuge.png)

At this point, our first TARS application is complete.